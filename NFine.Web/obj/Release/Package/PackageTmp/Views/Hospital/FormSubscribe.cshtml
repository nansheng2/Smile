<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>International Center for diagnosis and treatment</title>
    <link href="~/Content/css/uikit.min.css" rel="stylesheet" type="text/css">
    <link href="~/Content/css/customize.css" rel="stylesheet" type="text/css">
    <link href="~/Content/css/datepicker.min.css" rel="stylesheet" type="text/css">
    <script src="~/Content/js/jquery.js"></script>
    <script src="~/Content/js/uikit.min.js"></script>
    <script src="~/Content/js/datepicker.min.js"></script>
    <script src="~/Content/js/customize.js"></script>
</head>

<body>
    <div class="uk-container uk-container-center">
        <nav class="uk-navbar">
            <a href="~/Hospital/Index" class="uk-navbar-brand mtp18"><img src="~/Content/img/pages/logo.png" alt="" width="605" height="96" /></a>
            <div class="uk-navbar-flip mtp46">
                <ul class="uk-navbar-nav">
                    <li><a href="~/Hospital/Index">首页</a></li>
                    <li><a href="#">国际诊疗网</a></li>
                    <li><a href="#"><i class="uk-icon-home uk-icon-small"></i></a></li>
                </ul>
            </div>
        </nav>
    </div>
    <!-- form start -->
    <div class="uk-container uk-container-center ltlabel">
        <h3 class="confirm-tit"><img src="~/Content/img/pages/icon-res.png" alt="" />Reservation confirmation</h3>
        <form class="uk-form uk-form-horizontal">
            <h4 class="confirm-info uk-text-center">Your reservation information is:<span id="form-name"></span><i id="form-time"></i>，Registration fee:<i id="form-fee"></i>，Please choose the exact time of your visit!</h4>
            <div class="confirm-time">
                <div class="uk-form-row">
                    <div class="uk-form-controls uk-form-controls-text ml" id="form-PeriodList">
                        @*<span class="uk-text-center">*@
                        @*<input type="radio" id="radio1" name="radio">
                            <label for="radio1">07:50~08:50（Surplus:5）</label>
                            </span><span class="uk-text-center">
                            <input type="radio" id="radio2" name="radio">
                            <label for="radio2">07:50~08:50（Surplus:5）</label>
                            </span><span class="uk-text-center">
                            <input type="radio" id="radio3" name="radio">
                            <label for="radio3">07:50~08:50（Surplus:5）</label>
                            </span><span class="uk-text-center">
                            <input type="radio" id="radio4" name="radio">
                            <label for="radio4">07:50~08:50（Surplus:5）</label>
                            </span><span class="uk-text-center">
                            <input type="radio" id="radio5" name="radio">
                            <label for="radio5">07:50~08:50（Surplus:5）</label>*@
                        @*</span> *@

                    </div>
                </div>
            </div>
            <h4><i class="uk-icon-info-circle uk-icon-justify"></i>Please fill in personal information:</h4>
            <hr class="uk-article-divider">
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="cardnum"><span class="red">* </span>Credential Information</label>
                <div class="uk-form-controls">
                    <select id="idcard" class="uk-form-large">
                        <option value="1">Passport</option>
                        <option value="2">ID card</option>
                    </select>
                    <input type="text" onblur="FormSubscribe.FormValidation('cardnum');" id="cardnum" placeholder="Please enter your identification number" value="" class="uk-form-large w327">
                    <span class="uk-form-help-inline c9" id="cardnumButton">Seeing doctor is the real name system. Please fill in the real ID number</span>
                </div>
                <p class="ml170" id="cardnumError"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16">The ID card format is incorrect. Please enter the correct ID card</span></p>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="fullname"><span class="red">* </span>Full Name</label>
                <div class="uk-form-controls">
                    <input type="text" id="fullname" onblur="FormSubscribe.FormValidation('fullname');" placeholder="Please enter your full name" value="" class="uk-form-width-large uk-form-large w420">
                    <span class="uk-form-help-inline c9" id="fullnameButton">Please fill in the full name on the document</span>
                </div>
                <p class="ml170" id="fullnameError"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16">The Full Name format is incorrect. Please enter the correct Full Name</span></p>
            </div>

            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="visit"><span class="red">* </span>Visiting card number</label>
                <div class="uk-form-controls">
                    <select class="uk-form-width-large uk-form-large w420" id="visit"></select>
                    <span class="uk-form-help-inline c9" id="visitButton">No patients can not fill the card card, change required</span>
                </div>

            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right" for="gender"><span class="red">* </span>Gender</label>
                <div class="uk-form-controls uk-form-controls-text">
                    <input type="radio" id="male" name="radio" checked="checked" value="1">
                    <label for="male">male</label>
                    <input type="radio" id="female" name="radio" class="uk-margin-left" value="2">
                    <label for="female">female</label><br />
                    <p class="ml170" id="sexError" style="margin-left:0;"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16"> Please Check the correct Sex.</span></p>
                </div>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="birth"><span class="red">* </span>Date Of Birth</label>
                <div class="uk-form-controls">
                    <input type="text" id="birth" placeholder="Please select date" data-uk-datepicker="{format:'YYYY-MM-DD'}" class="uk-form-width-large uk-form-large w420" value="@DateTime.Now.ToString("yyyy-MM-dd")">
                </div>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="contact"><span class="red">* </span>Contact number</label>
                <div class="uk-form-controls">
                    <input type="text" id="contact" onblur="FormSubscribe.FormValidation('contact');" placeholder="Please enter the domestic mobile phone number" value="" class="uk-form-width-large uk-form-large w420">
                    <span class="uk-form-help-inline c9" id="contactButton">Please fill in the domestic mobile phone number for receiving reservation reminders</span>
                </div>
                <p class="ml170" id="contactError"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16">The Contact number format is incorrect. Please enter the correct Contact number</span></p>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="email"><span class="red">* </span>E-mail</label>
                <div class="uk-form-controls">
                    <input type="text" id="email" onblur="FormSubscribe.FormValidation('email');" placeholder="Please input your E-mail" value="" class="uk-form-width-large uk-form-large w420">
                    <span class="uk-form-help-inline c9" id="emailButton">Please fill in your email address@*<i class="uk-icon-check-circle uk-icon-medium green">*@@*</i>*@</span>
                </div>
                <p class="ml170" id="emailError"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16">The e-mail format is incorrect. Please enter the correct email address</span></p>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="nationality"><span class="red">* </span>Nationality</label>
                <div class="uk-form-controls">
                    <select class="uk-form-width-large uk-form-large w420" id="nationality">
                        @*<option>Egypt</option>
                            <option>Canada</option>
                            <option>USA</option>*@
                    </select>
                </div>
            </div>
            <div class="uk-form-row">
                <label class="uk-form-label uk-text-right mtp10" for="symptom"><span class="red">* </span>Symptom description</label>
                <div class="uk-form-controls">
                    <textarea cols="30" rows="5" id="symptom" onblur="FormSubscribe.FormValidation('symptom');" vocab="头痛" class="uk-form-width-large uk-form-large w420"></textarea>
                    <span class="uk-form-help-inline c9 description" id="symptomButton">Please give a brief description of your symptoms, to facilitateyour doctor's diagnosis and treatment,within 200 words</span>
                </div>
                <p class="ml170" id="symptomError"><i class="uk-icon-times-circle uk-icon-medium uk-icon-justify red"></i><span class="red f16">The Symptom description format is incorrect. Please enter the correct Symptom description</span></p>
            </div>
            <div class="uk-form-row">
                <div class="uk-form-controls uk-margin-bottom"><button type="button" class="uk-button btn-return uk-margin-right" onclick="return FormSubscribe.clearContent(this);">Return</button><button type="button" class="uk-button" onclick="FormSubscribe.submitForm();">Confirm</button></div>
            </div>
        </form>
    </div>
    <!-- form end -->
    <!-- footer start -->
    <div class="footer uk-margin-top">
        <div class="uk-container uk-container-center">
            <div class="uk-grid uk-grid-divider">
                <div class="uk-width-3-5">
                    <div class="uk-panel branch">
                        <h3 class="uk-panel-title">Branch information</h3>
                        <p>The First Affiliated Hospital of Xi'an Jiao Tong University Medical College</p>
                        <p>The First Affiliated Hospital of Binxian County Jiaotong University.</p>
                        <p>The First Affiliated Hospital of Hancheng Jiaotong University.</p>
                        <p>International land Hospital; land and port clinic.</p>
                    </div>
                </div>
                <div class="uk-width-2-5">
                    <div class="uk-panel social">
                        <h3 class="uk-panel-title uk-margin-bottom">About us</h3>
                        <p><a href="javascript:void(0)" class="uk-icon-button uk-icon-weibo"></a><a href="javascript:void(0)" class="uk-icon-button uk-icon-tencent-weibo"></a><a href="javascript:void(0)" class="uk-icon-button uk-icon-wechat"></a></p>
                        <p><img src="~/Content/img/pages/pic-ewm.png" alt="" /></p>
                        <p>Scanning concern Jiaotong University Affiliated Hospital</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="cp">
        <div class="uk-container uk-container-center"> Copyright &copy; 2011, the First Affiliated Hospital of Xi'an Jiao Tong University, Shaanxi Province, ICP 12009712, -3. Address: No. 277, Yanta West Road, Shaanxi, Xi'an: 710061 </div>
    </div>
    <!-- footer end -->
    <a id="dialog-form" href="#appointment" data-uk-modal="{center:true}"></a>
    <!-- popup start -->
    <div id="appointment" class="uk-modal" style="position:fixed;z-index:10000">
        <div class="uk-modal-dialog">
            <a class="uk-modal-close uk-close"></a>
            <div class="uk-modal-header">
                <h3>Reservation prompt</h3>
            </div>
            No card reservation is successful, please record this medical record number<span id="form-huiID" style="color:#940006;"></span>, go to the self-help machine for medical card, please keep in mind your medical card password, and then take the number to see a doctor!<i><span id="form-huiDocID"></span>, <span id="form-huiTime" style="color:#940006;"></span>.</i>
            <div class="uk-modal-footer uk-text-right">
                <button type="button" id="form-huiButton" class="uk-button uk-text-right" onClick="window.location.href='@Url.Content("~/Hospital/Doctor")'">Confirm</button>
            </div>
        </div>
    </div>

    <input type="hidden" id="form-OrderDoctorId" value="" />
    <input type="hidden" id="form-OrderDateTime" value="" />
    <input type="hidden" id="form-OrderDateTimeType" value="" />
    <input type="hidden" id="form-OrderType" value="" />
    <input type="hidden" id="form-BeginTime" value="" />
    <input type="hidden" id="form-EndTime" value="" />
    <input type="hidden" id="form-OrderDoctorName" value="" />
    <!-- popup end -->
    <script type="text/javascript">
        var docID, orderDate, orderTimeType;
        var flag = false;
        //获取地址栏参数
        function GetQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        }

        var FormSubscribe = function () {
            return {
                //正则验证
                FormValidation:function(id){

                    //身份证
                    var val = $("#idcard").find("option:selected").val();
                    if (id == "cardnum") {

                        //身份证验证
                        if (val == 2) {
                            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
                            var card = $("#cardnum").val();
                            if (reg.test(card) === false) {
                                //alert("身份证输入不合法");
                                $("#" + id + "Error").css("display", "block");
                                $("#" + id + "Error span.red").html("Seeing doctor is the real name system. Please fill in the real ID number");

                                return false;
                            } else {
                                $("#" + id + "Error").css("display", "none");
                                $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");
                            }
                        }
                        else
                        {
                            var card = $("#cardnum").val();
                            if (card.length > 1 && card.length <50) {
                                $("#" + id + "Error").css("display", "none");
                                $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");
                            }
                            else
                            {
                                $("#" + id + "Error").css("display", "block");
                                $("#" + id + "Error span.red").html("Seeing doctor is the real name system. Please fill in the real Passport");
                                return false;
                            }
                        }

                    }
                        //全名
                    else if (id == "fullname") {
                        if ($("#fullname").val().length <= 50 && $("#fullname").val().length >= 1) {
                            $("#" + id + "Error").css("display", "none");
                            $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");

                        } else {
                            $("#" + id + "Error").css("display", "block");
                            $("#" + id + "Error span.red").html("Please fill in the full name on the document");
                            return false;
                        }
                    }

                        //联系电话
                    else if (id == "contact") {
                        var rex = /^(1\d{10})$/;
                        var rex2 = /^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/;
                        var rex3 = /^1\d{10}$|^(0\d{2,3}-?|\(0\d{2,3}\))?[1-9]\d{4,7}(-\d{1,8})?$/;
                        var value = $("#contact").val();
                        if (!rex.test(value) && !rex2.test(value) && !rex3.test(value)) {
                            $("#" + id + "Error").css("display", "block");
                            $("#" + id + "Error span.red").html("Please fill in the domestic mobile phone number for receiving reservation reminders");
                            return false;;
                        } else {
                            $("#" + id + "Error").css("display", "none");
                            $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");


                        }
                    }

                        //email
                    else if (id == "email") {
                        var valemail = $("#email").val();
                        var reg = @Html.Raw("/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/");
                        if ($("#email").val().length <= 50 && $("#email").val().length >= 1) {
                            //再判断正则
                            if (reg.test(valemail)) {
                                $("#" + id + "Error").css("display", "none");
                                $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");
                            }else{
                                $("#" + id + "Error").css("display", "block");
                                $("#" + id + "Error span.red").html("Please fill in your email address");
                                return false;
                            }

                        } else {
                            $("#" + id + "Error").css("display", "block");
                            $("#" + id + "Error span.red").html("Please fill in your email address");
                            return false;
                        }
                    }

                        //症状
                    else if (id == "symptom") {
                        debugger;
                        if ($("#symptom").val().length <= 200 && $("#symptom").val().length >= 1) {
                            $("#" + id + "Error").css("display", "none");
                            $("#" + id + "Button").html("<i class=\"uk-icon-check-circle uk-icon-medium green\"></i>");

                        } else {
                            $("#" + id + "Error").css("display", "block");
                            $("#" + id + "Error span.red").html("Please give a brief description of your symptoms, to facilitateyour doctor's diagnosis and treatment,within 200 words");
                            return false;
                        }
                    }
                    flag = true;
                },

                //获取国际
                getNation: function () {
                    var url = "@Url.Content("~/UIManage/Common/GetNationality")";
                    $.ajax({
                        type: "post",
                        url: url,
                        success: function (data) {

                            var result = JSON.parse(data);
                            for (var i = 0; i < result.Result.length; i++) {
                                $("#nationality").append("<option value='" + result.Result[i].Id + "'>" + result.Result[i].Value + "</option>");
                            }

                        },
                        error: function (e) {


                        }
                    })
                },
                //提交事件
                submitForm: function () {
                    debugger;

                    $("#cardnum").blur();
                    $("#fullname").blur();
                    $("#contact").blur();
                    $("#email").blur();
                    $("#symptom").blur();
                    if (flag == false) {
                        //alert("请确保填写信息全部正确！");
                        return false;
                    }

                    //var el = document.getElementById('dialog-form');
                    //el.click();//触发打开事件

                    var url = "@Url.Content("~/UIManage/Doctor/UserOder")";
                    //获取值
                    var idcard = $("#idcard").find("option:selected").val();
                    var cardnum = $("#cardnum").val();
                    var fullname = $("#fullname").val();
                    var visit = $("#visit").find("option:selected").val();
                    var sexOption;

                    var val = $('input:radio[id="male"]:checked').val();
                    var vals = $('input:radio[id="female"]:checked').val();

                    //var male = $("#male").val();
                    //var female = $("#female").val();

                    if (val == 1) {
                        $("#sexError").css("display","none");
                        sexOption = 1;  //女
                    } else if (vals == 2) {
                        $("#sexError").css("display","none");
                        sexOption = 2;  //男
                    }else{
                        $("#sexError").css("display","block");
                        return false;
                    }
                    var birth = $("#birth").val();
                    var contact = $("#contact").val();
                    var email = $("#email").val();
                    //国籍怎么获取
                    var nationality = $("#nationality").find("option:selected").val();
                    var symptom = $("#symptom").val();

                    $("#form-huiButton").click(function (e) {

                        window.location.href = "../Hospital/Doctor?DocId=" + $("#form-OrderDoctorId").val();
                    })

                    //时间
                    if ($("#form-OrderType").val() == 1) {

                    }else{
                        var times = $("input:radio[name='radio-time']:checked").val();
                        var beTime = times.split("~");

                        $("#form-BeginTime").val($("#form-OrderDateTime").val() + " " + beTime[0]);
                        $("#form-EndTime").val($("#form-OrderDateTime").val() + " " + beTime[1]);
                    }


                    //组织数据
                    var data;
                    if ($("#form-OrderType").val() == 1) {
                        data = {
                            "CredentialInformation": cardnum,
                            "CredentialType": idcard,
                            "FullName": fullname,
                            "VisitingCardNumber": visit,
                            "Gender": sexOption,
                            "DateOfBirth": birth,
                            "ContactNumber": contact,
                            "Email": email,
                            "Nationality": nationality,
                            "SymptomDescription": symptom,
                            "OrderDoctorId":$("#form-OrderDoctorId").val(),
                            "OrderDateTime":$("#form-OrderDateTime").val(),
                            "OrderDateTimeType":$("#form-OrderDateTimeType").val(),
                            "OrderType":$("#form-OrderType").val()

                        };
                    }else{
                        data = {
                            "CredentialInformation": cardnum,
                            "CredentialType": idcard,
                            "FullName": fullname,
                            "VisitingCardNumber": visit,
                            "Gender": sexOption,
                            "DateOfBirth": birth,
                            "ContactNumber": contact,
                            "Email": email,
                            "Nationality": nationality,
                            "SymptomDescription": symptom,
                            "OrderDoctorId":$("#form-OrderDoctorId").val(),
                            "OrderDateTime":$("#form-OrderDateTime").val(),
                            "OrderDateTimeType":$("#form-OrderDateTimeType").val(),
                            "OrderType":$("#form-OrderType").val(),
                            "BeginTime":beTime[0],
                            "EndTime":beTime[1]

                        };
                    }
                    //请求数据
                    $.ajax({
                        type: "post",
                        url: url,
                        data: data,
                        success: function (data) {
                            debugger;
                            var result = JSON.parse(data);
                            //根据情况渲染页面
                            if (result.IsSuccess == true) {
                                $("#form-huiID").text(result.Result.OrderNumber);
                                //$("#form-huiDocID").text($("#form-OrderDoctorId").val());
                                $("#form-huiDocID").text($("#form-OrderDoctorName").val());
                                if ($("#form-OrderType").val() == 1) {  //依次
                                    if ($("#form-OrderDateTimeType") == 1) {
                                        $("#form-huiTime").text("AM");
                                    } else if ($("#form-OrderDateTimeType") == 2) {
                                        $("#form-huiTime").text("PM");
                                    } else if ($("#form-OrderDateTimeType") == 3) {
                                        $("#form-huiTime").text("Night");
                                    }
                                } else if ($("#form-OrderType").val() == 2) {  //分时间段
                                    $("#form-huiTime").text(result.Result.OrderTime.split(" ")[0]+" "+result.Result.BeginTime.split(' ')[1].substring(0,5) + "~" + result.Result.EndTime.split(' ')[1].substring(0,5));
                                }
                                //悬浮层打开
                                var el = document.getElementById('dialog-form');
                                el.click();//触发打开事件

                            } else {
                                alert(result.Reason);
                            }

                        },
                        error: function (e) {

                        }
                    })
                },
                //清空内容
                clearContent: function (e) {

                    //e.preventDefault();
                    $("input:radio[name='radio-time']:checked").attr('checked', false);
                    $("input:radio[name='radio']:checked").attr('checked', false);
                    $("#cardnum").val("");
                    $("#fullname").val("");
                    //visit的值
                    $("#birth").val("");
                    $("#contact").val("");
                    $("#email").val("");
                    //nationality的值
                    FormSubscribe.getNation();
                    $("#symptom").val("");
                    $("#form-BeginTime").val("");
                    $("#form-EndTime"), val("");
                    return false;
                }
            }
        }();

        $(function () {
            FormSubscribe.getNation();
            //上部
            docID = GetQueryString("DoctorId");//医生ID
            orderDate = GetQueryString("OrderDate");//预约时间
            orderTimeType = GetQueryString("OrderTimeType");//预约时间类型
            var url = "@Url.Content("~/UIManage/Doctor/GetDoctorOrderInfo")";
            var data = { DoctorId: docID, OrderDate: orderDate, OrderTimeType: orderTimeType };
            $.ajax({
                type: "post",
                url: url,
                data: data,
                success: function (data) {

                    var result = JSON.parse(data);
                    //渲染页面
                    //获取头部信息，渲染
                    var DoctorName = result.Result.DoctorName;
                    $("#form-OrderDoctorName").val(DoctorName);
                    var DoctorOrderType = "";
                    if (result.Result.DoctorOrderType == 1) {
                        DoctorOrderType = "ordinary"
                    } else if (result.Result.DoctorOrderType == 2) {
                        DoctorOrderType = "expert"
                    }
                    $("#form-name").text(DoctorName + DoctorOrderType);
                    var time = result.Result.OrderTime.split(" ");
                    var realTime = time[0];
                    var timeType;
                    if (result.Result.OrderTimeType == 1) {//上午
                        timeType = "AM";
                    } else if (result.Result.OrderTimeType == 2) {//下午
                        timeType = "PM";
                    } else if (result.Result.OrderTimeType == 3) {//晚上
                        timeType = "Night";
                    }
                    $("#form-time").text(realTime + timeType);
                    $("#form-fee").text(result.Result.OrderPrice + "RMB");

                    if (result.Result.OrderType == 2) {     //分时段

                        for (var i = 0; i < result.Result.PeriodList.length; i++) {


                            var bTime = result.Result.PeriodList[i].BeginTime.split(" ");
                            var bTimeRes = bTime[1];
                            bTimeRes = bTimeRes.substring(0, bTimeRes.length - 3);
                            var eTime = result.Result.PeriodList[i].EndTime.split(" ");
                            var eTimeRes = eTime[1];
                            eTimeRes = eTimeRes.substring(0, eTimeRes.length - 3);

                            //预约数量大于0
                            if(result.Result.PeriodList[i].OrderCount>0)
                            {
                                //第一个默认选中
                                if (i == 0) {
                                    $("#form-PeriodList").append("<span class=\"uk-text-center\"><input checked=\"checked\" type=\"radio\" id=\"radio" + i + 1 + "\" name=\"radio-time\" value = \"" + result.Result.PeriodList[i].BeginTime + "~" + result.Result.PeriodList[i].EndTime + "\">" +
                                        "<label for=\"radio" + i + 1 + "\">" + bTimeRes + "~" + eTimeRes + "（Surplus:" + result.Result.PeriodList[i].OrderCount + "）</label>" +
                                        "</span><span class=\"uk-text-center\"></span>");
                                }
                                else
                                {
                                    $("#form-PeriodList").append("<span class=\"uk-text-center\"><input type=\"radio\" id=\"radio" + i + 1 + "\" name=\"radio-time\" value = \"" + result.Result.PeriodList[i].BeginTime + "~" + result.Result.PeriodList[i].EndTime + "\">" +
                                        "<label for=\"radio" + i + 1 + "\">" + bTimeRes + "~" + eTimeRes + "（Surplus:" + result.Result.PeriodList[i].OrderCount + "）</label>" +
                                        "</span><span class=\"uk-text-center\"></span>");
                                }
                            }

                        }
                    }else if(result.Result.OrderType == 1){ //依次
                        $(".confirm-time").css("display","none");
                    }

                    $("#form-OrderDoctorId").val(docID);
                    $("#form-OrderDateTime").val(result.Result.OrderTime);
                    $("#form-OrderDateTimeType").val(result.Result.OrderTimeType);
                    $("#form-OrderType").val(result.Result.OrderType);
                    //if (result.Result.OrderType == 2) {
                    //    $("#form-BeginTime").val(result.Result)
                    //}

                    $(".ml170").css("display", "none");
                    //$("#sexError").css("display","block");
                    //$(".uk-form-help-inline").css("display", "none");
                },
                error: function (e) {

                }
            })

            //绑定证件号码输入事件进行ajax请求
            $("#cardnum").keydown(function () {
                var url = "/UIManage/User/GetUserInfo";
                var identificationNumber = $(this).val();
                var identificationType = $("#idcard").val();
                debugger;
                var data = { IdentificationType: 1, IdentificationNumber: identificationNumber};
                $.ajax({
                    type: "post",
                    url: url,
                    data: data,
                    success: function (data) {
                        debugger;
                        var result = JSON.parse(data);
                        if (result.IsSuccessfull == true)
                        {
                            $("#visit").empty();

                            $(result.Result).each(function (index, item) {
                                var name = item.Name;
                                var tel = item.Tel;
                                var gender = item.Gender;
                                var birthday = item.Birthday;
                                var cardNumber = item.CardNumber;
                                var value = name + "," + tel + "," + gender + "," + birthday;
                                $("#visit").append("<option value='" + value+"'>"+ cardNumber+"</option>");
                            });
                        }
                    },
                    error: function (e) {

                    }
                })
            });

            $("#visit").change(function () {
                var value = $(this).val();
                var name = value.split(',')[0];
                var tel = value.split(',')[1];
                var gender = value.split(',')[2];
                var birthday = value.split(',')[3];



                $("#fullname").val(name);
                $("#birth").val(birthday);
                $("#contact").val(tel);

                if (gender == 1) {
                    $("#male").attr('checked', 'checked');
                }
                else
                {
                    $("#female").attr('checked', 'checked');
                }
            });

        })

    </script>
</body>
</html>
